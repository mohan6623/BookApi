spring.application.name=springSecurity

server.port=8080
server.servlet.session.cookie.same-site=lax

#Database Configuration
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}

spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update

## HikariCP Connection Pool Settings
## Set max-lifetime to be shorter than the database's wait_timeout (usually 10-30 mins)
#spring.datasource.hikari.max-lifetime=600000
## Minimum number of idle connections to keep in the pool
#spring.datasource.hikari.minimum-idle=5
## Maximum number of connections in the pool
#spring.datasource.hikari.maximum-pool-size=6
## Time to wait for a connection from the pool before throwing an exception
#spring.datasource.hikari.connection-timeout=30000
## Keep-alive helps prevent firewalls from dropping idle connections
#spring.datasource.hikari.keepalive-time=30000

#Email Configuration
spring.mail.host=${SPRING_MAIL_HOST}
spring.mail.port=${SPRING_MAIL_PORT}
spring.mail.username=${SPRING_MAIL_USERNAME}
spring.mail.password=${SPRING_MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true


# OAuth2 Configuration - Google (use env vars in prod)
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri=${GOOGLE_REDIRECT_URI}

# OAuth2 Configuration - GitHub
spring.security.oauth2.client.registration.github.client-id=${GITHUB_CLIENT_ID}
spring.security.oauth2.client.registration.github.client-secret=${GITHUB_CLIENT_SECRET}
spring.security.oauth2.client.registration.github.scope=user:email
spring.security.oauth2.client.registration.github.redirect-uri=${GITHUB_REDIRECT_URI}

# File Upload Configuration
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Cloudinary Configuration
cloudinary.cloud_name=${CLOUDINARY_CLOUD_NAME}
cloudinary.api_key=${CLOUDINARY_API_KEY}
cloudinary.api_secret=${CLOUDINARY_API_SECRET}

# JWT Configuration
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:1800000}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# Server error details
server.error.include-message=always
server.error.include-binding-errors=always

# Frontend URL
app.frontend.url=${APP_FRONTEND_URL}


# ============================================================================
# RATE LIMITING CONFIGURATION
# ============================================================================
# Caffeine-based in-memory rate limiting for single-instance deployment
# Can be easily migrated to Redis for multi-instance scaling

# Global Settings
ratelimit.enabled=${RATE_LIMIT_ENABLED:true}
ratelimit.include-headers=${RATE_LIMIT_HEADERS:true}

# Cache Configuration
ratelimit.cache.max-size=10000
ratelimit.cache.expire-hours=2

#White List Ips
whitelist=${WHITE_LIST}

# ============================================================================
# ENDPOINT-SPECIFIC RATE LIMITS
# ============================================================================

# User Registration
# Prevents spam accounts and abuse
ratelimit.register.requests=5
ratelimit.register.window-seconds=3600

# User Login
# Prevents brute force attacks
ratelimit.login.requests=10
ratelimit.login.window-seconds=900

# Email Verification
# Prevents verification link abuse
ratelimit.verify.requests=5
ratelimit.verify.window-seconds=3600

# Resend Verification Email
# Strict limit to prevent email spam
ratelimit.resend.requests=1
ratelimit.resend.window-seconds=300

# Password Reset
# Prevents password reset abuse
ratelimit.reset-password.requests=3
ratelimit.reset-password.window-seconds=3600

# Username/Email Availability Check
# Allows reasonable checking but prevents enumeration attacks
ratelimit.available.requests=20
ratelimit.available.window-seconds=60

# OAuth Callback
# Prevents OAuth flow abuse
ratelimit.oauth.requests=10
ratelimit.oauth.window-seconds=3600